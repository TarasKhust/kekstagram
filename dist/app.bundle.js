!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=16)}([function(e,t,n){"use strict";!function(){var e=document.querySelector("main"),t=document.querySelector("#success").content.querySelector(".success"),n=function(e){"SECTION"===e.target.tagName&&window.error.closeModal()},r=function(e){return window.util.isEscEvent(e,window.error.closeModal(t))};window.success={show:function(){document.addEventListener("keydown",r),e.appendChild(t),t.querySelector(".success__button").addEventListener("click",function(){window.error.closeModal(t)}),t.addEventListener("click",n)}}}()},function(e,t,n){"use strict";!function(){var e=document.querySelector("main"),t=document.querySelector("#error").content.querySelector(".error"),n=function(e){"SECTION"===e.target.tagName&&r()},r=function(t){e.removeChild(t),document.removeEventListener("keydown",o),document.removeEventListener("click",n)},o=function(e){return window.util.isEscEvent(e,r)};window.error={show:function(i){e.appendChild(t),t.querySelector(".error__title").textContent=i,t.querySelector(".error__button").addEventListener("click",function(){return r()}),t.addEventListener("click",n),document.addEventListener("keydown",o)},closeModal:r}}()},function(e,t,n){"use strict";!function(){var e=document.querySelector(".big-picture");e.querySelector(".big-picture__cancel").addEventListener("click",function(){return t()});var t=function(){return e.classList.add("hidden")},n=function(e){return window.util.isEscEvent(e,t)};window.picture={openPhoto:function(){e.classList.remove("hidden"),e.querySelector(".social__comments").innerHTML="",document.addEventListener("keydown",n)}}}()},function(e,t,n){"use strict";!function(){var e={chrome:{CLASS:"effects__preview--chrome",PROPERTY:"grayscale",MIN_VALUE:0,MAX_VALUE:1,UNIT:""},sepia:{CLASS:"effects__preview--sepia",PROPERTY:"sepia",MIN_VALUE:0,MAX_VALUE:1,UNIT:""},marvin:{CLASS:"effects__preview--marvin",PROPERTY:"invert",MIN_VALUE:0,MAX_VALUE:100,UNIT:"%"},phobos:{CLASS:"effects__preview--phobos",PROPERTY:"blur",MIN_VALUE:0,MAX_VALUE:3,UNIT:"px"},heat:{CLASS:"effects__preview--heat",PROPERTY:"brightness",MIN_VALUE:1,MAX_VALUE:3,UNIT:""}},t=100,n=100,r={MIN:0,MAX:100},o=document.querySelector(".img-upload"),i=o.querySelector(".img-upload__preview").querySelector(".img-upload__preview img"),c=o.querySelector(".effect-level"),u=o.querySelector(".effects__list"),a=c.querySelector(".effect-level__pin"),l=c.querySelector(".effect-level__depth"),s=c.querySelector(".effect-level__value"),d=u.querySelector(".effects__radio:checked"),f=c.querySelector(".effect-level__line"),m=function(t){i.style.filter="none"===d?"":e[d].PROPERTY+"("+w(d,t)+")",v(t)},v=function(e){a.style.left=e+"%",s.value=Math.round(e),l.style.width=a.style.left},w=function(n,r){return r*(e[n].MAX_VALUE-e[n].MIN_VALUE)/t+e[n].MIN_VALUE+e[n].UNIT};u.addEventListener("click",function(e){var t=e.target;"INPUT"===t.tagName&&(i.classList="",d=t.value,i.classList.add("effects__preview--"+d),i.style.filter="","none"===d?c.classList.add("hidden"):c.classList.remove("hidden"),s.value=n,m(n),v())}),f.addEventListener("mousedown",function(e){var t=e.clientX,n=f.getBoundingClientRect(),o=(t-n.left)/n.width*100;v(o),m(o);var i=function(e){var o=t-e.clientX;t=e.clientX;var i=(a.offsetLeft-o)/n.width*100;i<=r.MIN?(i=r.MIN,s.value=r.MIN):i>=r.MAX&&(i=r.MAX,s.value=r.MAX),m(i)};document.addEventListener("mousemove",i),document.addEventListener("mouseup",function e(t){t.preventDefault(),document.removeEventListener("mousemove",i),document.removeEventListener("mousemove",e)})}),window.effects={PinValue:r}}()},function(e,t,n){"use strict";!function(){var e=25,t=25,n=100,r=document.querySelector(".img-upload"),o=r.querySelector(".img-upload__scale"),i=o.querySelector(".scale__control--value"),c=o.querySelector(".scale__control--smaller"),u=o.querySelector(".scale__control--bigger"),a=r.querySelector(".img-upload__preview"),l=function(r){var o=parseInt(i.value,10);return(o+=t*r)>=e&&o<=n&&(i.value=o+"%",o/=100,a.style.transform="scale("+o+")"),o};c.addEventListener("click",function(){return l(-1)}),u.addEventListener("click",function(){return l(1)})}()},function(e,t,n){"use strict";!function(){var e=5,t="#",n=20,r=document.querySelector(".img-upload"),o=document.querySelector(".text__hashtags"),i=r.querySelector(".img-upload__submit");o.addEventListener("input",function(){o.style.outline="";var r="",i=o.value.trim();if(""!==i){var c=i.toLowerCase().split(" ");c.forEach(function(o){o.charAt(0)!==t?r="Хэштег должен начинаться с символа #":o.indexOf(t,1)>1?r="Хэш-теги разделяются пробелами":o.charAt(0)===t&&1===o.length?r="Хеш-тег не может состоять только из одной решётки":c.length>e?r="Допустимое количество  хэштегов  не более 5":o.length>n?r="Максимальная длина одного хэш-тега 20 символов, включая решётку":function(e){for(var t=0;t<e.length;t++)for(var n=e[t],r=0;r<e.length;r++)if(n===e[r]&&t!==r)return!0;return!1}(c)&&(r="Хэштеги не должны повторяться")}),o.setCustomValidity(r)}else o.setCustomValidity(r)});var c=function(e){e.validity.valid?e.style.outline="none":e.style.outline="2px solid red"};i.addEventListener("click",function(){c(o)}),i.addEventListener("submit",function(){c(o)})}()},function(e,t,n){"use strict";!function(){var e=["gif","jpg","jpeg","png"],t=document.querySelector(".img-upload__start input[type=file]"),n=document.querySelector(".img-upload__preview img");t.addEventListener("change",function(){var r=t.files[0],o=r.name.toLowerCase();if(e.some(function(e){return o.endsWith(e)})){var i=new FileReader;i.addEventListener("load",function(){n.src=i.result}),i.readAsDataURL(r)}})}()},function(e,t,n){"use strict";!function(){var e=document.querySelector(".img-upload__form"),t=document.querySelector(".img-upload"),n=t.querySelector("#upload-file"),r=t.querySelector(".img-upload__submit"),o=t.querySelector(".img-upload__overlay"),i=t.querySelector("#upload-cancel"),c=document.querySelector(".text__hashtags"),u=document.querySelector(".text__description"),a=function(){o.classList.add("hidden"),n.value=null,document.removeEventListener("keydown",l)},l=function(e){return window.util.isEscEvent(e,a)};document.querySelector("#upload-select-image").addEventListener("change",function(){return o.classList.remove("hidden"),r.disabled=!1,void document.addEventListener("keydown",l)}),i.addEventListener("click",function(){return a()}),c.addEventListener("focusin",function(){return document.removeEventListener("keydown",l)}),c.addEventListener("focusout",function(){return document.addEventListener("keydown",l)}),u.addEventListener("focusin",function(){return document.removeEventListener("keydown",l)}),u.addEventListener("focusout",function(){return document.addEventListener("keydown",l)});var s=function(e){a(),window.error.show(e)},d=function(){a(),window.success.show()};e.addEventListener("submit",function(t){window.backend.upload(new FormData(e),d,s),r.disabled=!0,t.preventDefault()})}()},function(e,t,n){"use strict";!function(){var e=1,t=6,n=document.querySelector(".big-picture"),r=document.querySelector(".comments-loader"),o=document.querySelector(".social__comment-count");r.classList.add("visually-hidden"),o.classList.add("visually-hidden");var i=document.querySelector("#comment").content.querySelector(".social__comment"),c=function(r){var o=n.querySelector(".social__comments"),c=document.createDocumentFragment();r.forEach(function(n,r){var o=function(n){var r=i.cloneNode(!0),o=window.util.getRandomNumber(e,t);return r.querySelector(".social__picture").src="img/avatar-"+o+".svg",r.querySelector(".social__text").textContent=n,r}(n);r>=5&&o.classList.add("visually-hidden"),c.appendChild(o)}),o.appendChild(c)};window.preview={renderBigPicture:function(e){n.querySelector(".big-picture__img img").src=e.url,n.querySelector(".likes-count").textContent=e.likes,n.querySelector(".comments-count").textContent=e.comments.length,n.querySelector(".social__caption").textContent=e.description,c(e.comments)}}}()},function(e,t,n){"use strict";!function(){var e=void 0,t=document.querySelector(".img-filters"),n=t.querySelector("#filter-popular"),r=t.querySelector("#filter-new"),o=t.querySelector("#filter-discussed"),i=function(e){var n=t.querySelector(".img-filters__button--active");n?n.classList.remove("img-filters__button--active"):e.classList.add("img-filters__button--active")},c=function(){document.querySelectorAll(".picture").forEach(function(e){e.remove()})},u=function(t){e&&clearTimeout(e),e=setTimeout(function(){c(),window.gallery.renderPhoto(t)},500)};n.addEventListener("click",function(){i(n),window.filters.currentData=window.gallery.initialData,u(window.filters.currentData)}),r.addEventListener("click",function(){i(r);var t=window.gallery.initialData.slice();e&&clearTimeout(e),e=setTimeout(function(){c(),window.filters.currentData=function(e){for(var t=0;t<e.length;t++){var n=Math.round(Math.random()*(e.length-1)),r=e[t];e[t]=e[n],e[n]=r}return e}(t).splice(0,10),window.gallery.appendPhotos(window.filters.currentData)},500)}),o.addEventListener("click",function(){i(o);var e=window.gallery.initialData.slice();window.filters.currentData=e.sort(function(e,t){return t.comments.length-e.comments.length}),u(window.filters.currentData)}),window.filters={filtersElement:t,currentData:[]}}()},function(e,t,n){"use strict";!function(){var e=document.querySelector("#picture").content.querySelector(".picture"),t=document.querySelector(".pictures"),n=document.querySelector(".img-filters"),r=function(t){var n=e.cloneNode(!0);return n.querySelector(".picture__img").src=t.url,n.querySelector(".picture__likes").textContent=t.likes,n.querySelector(".picture__comments").textContent=t.comments.length,n.addEventListener("click",function(){window.picture.openPhoto(),window.preview.renderBigPicture(t)}),n},o=function(){var e=document.createDocumentFragment();window.data.generatePhotos().forEach(function(t){e.appendChild(r(t))}),t.appendChild(e)};window.gallery={initialData:[],appendPhotos:o,renderPhoto:r};var i=function(e){window.gallery.initialData=e,window.filters.currentData=e,window.filters.filtersElement.classList.remove("img-filters--inactive"),o()};!function(e){window.backend.load(i),e()}(function(){return n.classList.remove("img-filters--inactive")})}()},function(e,t,n){"use strict";!function(){var e=["Тестим новую камеру!","Затусили с друзьями на море","Как же круто тут кормят","Отдыхаем...","Цените каждое мгновенье. Цените тех, кто рядом с вами и отгоняйте все сомненья. Не обижайте всех словами......","Вот это тачка!"],t=["Всё отлично!","В целом всё неплохо. Но не всё.","Когда вы делаете фотографию, хорошо бы убирать палец из кадра. В конце концов это просто непрофессионально.","Моя бабушка случайно чихнула с фотоаппаратом в руках и у неё получилась фотография лучше.","Я поскользнулся на банановой кожуре и уронил фотоаппарат на кота и у меня получилась фотография лучше.","Лица у людей на фотке перекошены, как будто их избивают. Как можно было поймать такой неудачный момент?!"],n=15,r=200,o=function(){var e=window.util.getRandomElement(t);return Math.random()>=.5&&(e+=" "+window.util.getRandomElement(t)),e},i=function(){for(var e=[],t=0;t<window.util.getRandomNumber(1,10);t++)e[t]=o();return e};window.data={generatePhotos:function(){for(var t=[],o=1;o<=25;o++)t[o]={url:"photos/"+o+".jpg",likes:window.util.getRandomNumber(n,r),comments:i(),description:window.util.getRandomElement(e)};return t}}}()},function(e,t,n){"use strict";!function(){var e="https://js.dump.academy/kekstagram/data",t="https://js.dump.academy/kekstagram/",n=200,r=404,o=500,i=function(e,t){var i=new XMLHttpRequest;return i.responseType="json",i.timeout=1e4,i.addEventListener("load",function(){switch(i.status){case n:e(i.response);break;case o:t("Внутренняя ошибка сервера: "+i.status+" "+i.statusText);break;case r:t("404 Not Found");break;default:t("Статус ответа: "+i.status+" "+i.statusText)}}),i.addEventListener("error",function(){return t("Произошла ошибка соединения")}),i.addEventListener("timeout",function(){return t("Запрос не успел выполниться за "+i.timeout+"мс")}),i};window.backend={load:function(t,n){var r=i(t,n);r.open("GET",e),r.send()},upload:function(e,n,r){var o=i(n,r);o.open("POST",t),o.send(e)}}}()},function(e,t,n){"use strict";window.util={getRandomNumber:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},getRandomElement:function(e){return e[Math.floor(Math.random()*e.length)]},KeyCode:{ENTER:13,ESC:27},isEscEvent:function(e,t){e.keyCode===window.util.KeyCode.ESC&&t()},isEnterEvent:function(e,t){e.keyCode===window.util.KeyCode.ENTER&&t()}}},function(e,t){},function(e,t){},function(e,t,n){"use strict";n(15),n(14),n(13),n(12),n(11),n(10),n(9),n(8),n(7),n(6),n(5),n(4),n(3),n(2),n(1),n(0)}]);
//# sourceMappingURL=app.bundle.js.map